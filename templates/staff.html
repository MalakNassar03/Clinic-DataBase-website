<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Staff</title>
    <link
      rel="icon"
      href="../static/images/medical-team.png"
      type="image/x-icon"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="{{ url_for('static', filename='staff.css') }}"
    />
    <link rel="stylesheet" href="../static/staff.css" />
  </head>
  <body style="background-color: #f6f5ec">
    <div class="header">
      <img src="../static/images/medical-team.png" class="patientImage" />
      <p class="patient_p">Staff</p>
      <!--*********************************************************************-->

      <label for="search" class="Search_label">Search:</label>
      <input
        type="text"
        id="search"
        name="search"
        placeholder="Search..."
        class="Search_container"
      />
      <label for="searchType" class="label-color"></label>
      <select
        id="searchType"
        name="searchType"
        onchange="toggleSearchFields()"
        class="dropdown_search"
      >
        <option value="Select" selected disabled>Select</option>
        <option value="staffID">staffID</option>
        <option value="staffName">staffName</option>
        <option value="jobDescription">jobDescription</option>
        <option value="salary">salary</option>
        <option value="staffPhoneNumber">staffPhoneNumber</option>
        <option value="workDays">workDays</option>
        <option value="workingHours">workingHours</option>
        <option value="staffPassword">staffPassword</option>
      </select>
      <button onclick="searchStaff()" class="search_button">
        <img src="../static/images/find.png" alt="search Staff" />
      </button>
      <button onclick="refreshTable()" class="search_button">
        <img src="../static/images/refresh.png" alt="search Staff" />
      </button>

      <!--*********************************************************************-->

      <div class="table">
        <table class="content-table">
          <thead>
            <tr>
              <th>
                <a
                  href="{{ url_for('staff', sort_by='staffID', sort_order=new_sort_order) }}"
                  >Staff ID</a
                >
              </th>
              <th>
                <a
                  href="{{ url_for('staff', sort_by='staffName', sort_order=new_sort_order) }}"
                  >Staff Name</a
                >
              </th>
              <th>
                <a
                  href="{{ url_for('staff', sort_by='jobDescription', sort_order=new_sort_order) }}"
                  >Job Description</a
                >
              </th>
              <th>
                <a
                  href="{{ url_for('staff', sort_by='salary', sort_order=new_sort_order) }}"
                  >Salary</a
                >
              </th>
              <th>
                <a
                  href="{{ url_for('staff', sort_by='staffPhoneNumber', sort_order=new_sort_order) }}"
                  >Staff Phone Number</a
                >
              </th>
              <th>
                <a
                  href="{{ url_for('staff', sort_by='workDays', sort_order=new_sort_order) }}"
                  >Work Days</a
                >
              </th>
              <th>
                <a
                  href="{{ url_for('staff', sort_by='workingHours', sort_order=new_sort_order) }}"
                  >Working Days Hours</a
                >
              </th>
              <th>
                <a
                  href="{{ url_for('staff', sort_by='staffPassword', sort_order=new_sort_order) }}"
                  >Password</a
                >
              </th>
            </tr>
          </thead>
          <tbody>
            {% for row in staff_data %}
            <tr>
              <td>{{ row['staffID'] }}</td>
              <td>{{ row['staffName'] }}</td>
              <td>{{ row['jobDescription'] }}</td>
              <td>{{ row['salary'] }}</td>
              <td>{{ row['staffPhoneNumber'] }}</td>
              <td>{{ row['workDays'] }}</td>
              <td>{{ row['workingHours'] }}</td>
              <td>{{ row['staffPassword'] }}</td>
            </tr>
            {% endfor %}
          </tbody>
          <!-- <tfoot >
            <tr>
              <td>Total Salary Expense:</td>
              <td> {{ total_salary_expense }}</td>
            </tr>
          </tfoot> -->
        </table>
      </div>

      <!--*********************************************************************-->

      <div id="functions">
        <label for="operationType" class="label-color"
          >Select Operation Type:</label
        >
        <select
          id="operationType"
          name="operationType"
          onchange="toggleFields()"
          class="round-dropdown"
        >
          <option value="Select" selected disabled>Select</option>
          <option value="insert">Insert</option>
          <option value="delete">Delete</option>
          <option value="update">Update</option>
          <option value="clear">Clear All</option>
          <option value="total">Tatal Salarys</option>
          <option value="numOfPaitent">Num Of Paitent</option>


        </select>
        <div class="Insert">
          <div id="insertStaff">
            <form action="/add_staff" method="post">
              <div class="input-group_first_row">
                <label for="staffName">Staff Name: </label>
                <input type="text" id="staffName" name="staffName" pattern="[A-Za-z\s]+" title="Please enter only letters and spaces."
                 required />

                <label for="jobDescription" style="padding-left: 5px">
                  Job Description:</label
                >
                <input
                  type="text"
                  id="jobDescription"
                  name="jobDescription"
                  pattern="[A-Za-z\s]+" title="Please enter only letters and spaces."

                  required
                />

                <label for="salary" style="padding-left: 5px"> Salary:</label>
                <input type="text" id="salary" name="salary"  pattern="[0-9\s]+" title="Please enter only digits."
                required />

                <label for="staffPhoneNumber" style="padding-left: 5px">
                  PhoneNumber:</label
                >
                <input
                  type="text"
                  id="staffPhoneNumber"
                  name="staffPhoneNumber"
                  pattern="[0-9\s]+" title="Please enter only digits."

                  required
                />
              </div>
              <div class="input-group_second_row">
                <label for="workDays" style="color: #92725d"
                  ><br />WorkDays:</label
                >
                <input type="text" id="workDays" name="workDays" required />

                <label for="workingHours" style="padding-left: 11px"
                  >WorkingHours:</label
                >
                <input
                  type="text"
                  id="workingHours"
                  name="workingHours"
                  pattern="[0-9\s]+" title="Please enter only digits."

                  required
                  style="width: 50px"
                />

                <label for="staffPassword" style="padding-left: 5px"
                  >StaffPassword:</label
                >
                <input
                  type="text"
                  id="staffPassword"
                  name="staffPassword"
                  required
                />

                <button type="submit">
                  <img
                    src="../static/images/add-user.png"
                    alt="Insert Patient"
                  />
                  <span style="font-size: 12px; color: #92725d"
                    ><p>Add</p></span
                  >
                </button>
              </div>
            </form>
          </div>
        </div>

        <!--*********************************************************************-->
        <div class="Delete">
          <div id="deleteFields">
            <form action="/delete_staff" method="post">
              <label for="staffID">Staff ID:</label>
              <input type="text" id="staffID1" name="staffID"  pattern="[0-9\s]+" title="Please enter only digits."
              required />
              <button type="submit">
                <img
                  src="../static/images/remove-user.png"
                  alt="Insert Patient"
                />
                <span style="font-size: 12px; color: #92725d"
                  ><p>Delete</p></span
                >
              </button>
            </form>
          </div>
        </div>
        <!--*********************************************************************-->
        <div class="Update">
          <div id="updateFields">
            <form action="/update_staff" method="post">
              <div class="input-group_first_row_update">
                <label for="staffID">Staff ID:</label>
                <input
                  type="text"
                  id="staffID"
                  name="staffID"
                  value="{{ staff_data['staffID'] }}"
                  pattern="[0-9\s]+" title="Please enter only digits."

                  required
                />

                <label for="staffName" style="padding-left: 8px"
                  >StaffName:</label
                >
                <input
                  type="text"
                  id="staffName"
                  name="staffName"
                  value="{{ staff_data['staffName'] }}"
                  pattern="[A-Za-z\s]+" title="Please enter only letters and spaces."

                />

                <label for="jobDescription" style="padding-left: 8px"
                  >Job Description:</label
                >
                <input
                  type="text"
                  id="jobDescription"
                  name="jobDescription"
                  value="{{ staff_data['jobDescription'] }}"
                  pattern="[A-Za-z\s]+" title="Please enter only letters and spaces."

                />

                <label for="salary" style="padding-left: 8px">Salary:</label>
                <input
                  type="text"
                  id="salary"
                  name="salary"
                  value="{{ staff_data['salary'] }}"
                  pattern="[0-9\s]+" title="Please enter only digits."

                />
              </div>
              <div class="input-group_second_row_update">
                <label for="staffPhoneNumber">PhoneNumber:</label>
                <input
                  type="text"
                  id="staffPhoneNumber"
                  name="staffPhoneNumber"
                  value="{{ staff_data['staffPhoneNumber'] }}"
                  pattern="[0-9\s]+" title="Please enter only digits."

                />

                <label for="workDays" style="padding-left: 8px"
                  >Work Days:</label
                >
                <input
                  type="text"
                  id="workDays"
                  name="workDays"
                  value="{{ staff_data['workDays'] }}"
                />

                <label for="workingHours" style="padding-left: 8px"
                  >Working Hours:</label
                >
                <input
                  type="text"
                  id="workingHours"
                  name="workingHours"
                  value="{{ staff_data['workingHours'] }}"
                  style="width: 50px"
                  pattern="[0-9\s]+" title="Please enter only digits."

                />

                <label for="staffPassword" style="padding-left: 8px"
                  >Staff Password:</label
                >
                <input
                  type="text"
                  id="staffPassword"
                  name="staffPassword"
                  value="{{ staff_data['staffPassword'] }}"
                />
              </div>
              <div class="input-group_third_row_update">
                <button type="submit">
                  <img src="../static/images/renew.png" alt="Update Patient" />
                  <span style="font-size: 12px; color: #92725d"
                    ><p>Update</p></span
                  >
                </button>
              </div>
            </form>
          </div>
        </div>

        <!--*********************************************************************-->

        <div class="clear">
          <div id="clear">
            <form action="{{ url_for('clear_all_staff') }}" method="post">
              <!-- <label for="staffID">Staff ID:</label> -->
              <!-- <input type="text" id="staffID1" name="staffID" required /> -->
              <button type="submit">
                <img src="../static/images/eraser.png" alt="Clear All" />
                <span style="font-size: 12px; color: #92725d"
                  ><p>Clear All</p></span
                >
              </button>
            </form>
          </div>
        </div>

        <!--*********************************************************************-->
        <div class="total">
          <div id="total">
              <label for="total" style="color: #92725d;">Total Salary Expense:</label>
              <label for="total" style="color: #92725d;"> {{ total_salary_expense }}</label>
              <br>
              <br>
              <label  for="total" style="color: #92725d;">Average Salary:</label>
              <label for="total" style="color: #92725d;"> {{ average_salary }}</label>

                  </div>
        </div>

        <!--*********************************************************************-->

        <div class="numOfPaitent">
          <div id="numOfPaitent">
              <div class="table">
                <table class="content-table">
                  <thead>
                    <tr>
                      <th>
                        <a href="{{ url_for('staff', sort_by='staffID', sort_order=new_sort_order) }}">Staff ID</a>
                      </th>
                      <th>
                        <a href="{{ url_for('staff', sort_by='staffName', sort_order=new_sort_order) }}">Staff Name</a>
                      </th>
                      <th>
                        <a href="{{ url_for('staff', sort_by='num_assigned_patients', sort_order=new_sort_order) }}">Num Assigned Patients</a>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for row in num_assigned_patients %}
                    <tr>
                      <td>{{ row['staffID'] }}</td>
                      <td>{{ row['staffName'] }}</td>
                      <td>{{ row['num_assigned_patients'] }}</td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>

            <!-- </form> -->
          </div>
        </div>
        <!--*********************************************************************-->
      </div>
    </div>
    <!--*********************************************************************-->

    <script>
      window.onload = function () {
        toggleFields();
      };
      function toggleFields() {
        var operationType = document.getElementById("operationType").value;

        // Show/hide fields based on selection
        if (operationType === "Select") {
          document.getElementById("insertStaff").style.display = "none";
          document.getElementById("deleteFields").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("updateFields").style.display = "none"; // Hide updateFields if needed
          document.getElementById("clear").style.display = "none";
          document.getElementById("total").style.display = "none";
          document.getElementById("numOfPaitent").style.display = "none";



        } else if (operationType === "insert") {
          document.getElementById("insertStaff").style.display = "block";
          document.getElementById("deleteFields").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("updateFields").style.display = "none"; // Hide updateFields if needed
          document.getElementById("clear").style.display = "none";
          document.getElementById("total").style.display = "none";
          document.getElementById("numOfPaitent").style.display = "none";

        } else if (operationType === "delete") {
          document.getElementById("insertStaff").style.display = "none";
          document.getElementById("deleteFields").style.display = "block";
          document.getElementById("updateFields").style.display = "none";
          document.getElementById("clear").style.display = "none";
          document.getElementById("total").style.display = "none";
          document.getElementById("numOfPaitent").style.display = "none";

        } else if (operationType === "update") {
          document.getElementById("insertStaff").style.display = "none";
          document.getElementById("deleteFields").style.display = "none";
          document.getElementById("updateFields").style.display = "block";
          document.getElementById("clear").style.display = "none";
          document.getElementById("total").style.display = "none";
          document.getElementById("numOfPaitent").style.display = "none";

        } else if (operationType === "clear") {
          document.getElementById("insertStaff").style.display = "none";
          document.getElementById("deleteFields").style.display = "none";
          document.getElementById("updateFields").style.display = "none";
          document.getElementById("clear").style.display = "block";
          document.getElementById("total").style.display = "none";
          document.getElementById("numOfPaitent").style.display = "none";

        }
        else if (operationType === "total") {
          document.getElementById("insertStaff").style.display = "none";
          document.getElementById("deleteFields").style.display = "none";
          document.getElementById("updateFields").style.display = "none";
          document.getElementById("clear").style.display = "none";
          document.getElementById("total").style.display = "block";
          document.getElementById("numOfPaitent").style.display = "none";

        }
        else if (operationType === "numOfPaitent") {
          document.getElementById("insertStaff").style.display = "none";
          document.getElementById("deleteFields").style.display = "none";
          document.getElementById("updateFields").style.display = "none";
          document.getElementById("clear").style.display = "none";
          document.getElementById("total").style.display = "none";
          document.getElementById("numOfPaitent").style.display = "block";

        }
      }

      function refreshTable() {
        fetch("/get_all_staff") // Replace with the endpoint that fetches all patients
          .then((response) => response.json())
          .then((data) => updateTable(data));
      }

      function searchStaff() {
        var searchTerm = document.getElementById("search").value;
        var searchType = document.getElementById("searchType").value;

        // Make an AJAX request to your Flask server
        fetch(`/search_staff_${searchType}?search=${searchTerm}`)
          .then((response) => response.json())
          .then((data) => updateTable(data));
      }
      function toggleSearchFields() {
        if (searchType === "Select") {
          document.getElementById("staffID").style.display = "none";
          document.getElementById("staffName").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "none"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "none"; // Hide updateFields if needed
        } else if (searchType === "staffID") {
          document.getElementById("staffID").style.display = "block";
          document.getElementById("staffName").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "none"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "none"; // Hide updateFields if needed
        } else if (searchType === "staffName") {
          document.getElementById("staffID").style.display = "none";
          document.getElementById("staffName").style.display = "block"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "none"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "none"; // Hide updateFields if needed
        } else if (searchType === "jobDescription") {
          document.getElementById("staffID").style.display = "none";
          document.getElementById("staffName").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "block"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "none"; // Hide updateFields if needed
        } else if (searchType === "salary") {
          document.getElementById("staffID").style.display = "none";
          document.getElementById("staffName").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "none"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "block"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "none"; // Hide updateFields if needed
        } else if (searchType === "staffPhoneNumber") {
          document.getElementById("staffID").style.display = "none";
          document.getElementById("staffName").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "none"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "block"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "none"; // Hide updateFields if needed
        } else if (searchType === "workDays") {
          document.getElementById("staffID").style.display = "none";
          document.getElementById("staffName").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "none"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "block"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "none"; // Hide updateFields if needed
        } else if (searchType === "workingHours") {
          document.getElementById("staffID").style.display = "none";
          document.getElementById("staffName").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "none"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "block"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "none"; // Hide updateFields if needed
        } else if (searchType === "staffPassword") {
          document.getElementById("staffID").style.display = "none";
          document.getElementById("staffName").style.display = "none"; // Hide deleteFields if needed
          document.getElementById("jobDescription").style.display = "none"; // Hide updateFields if needed
          document.getElementById("salary").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPhoneNumber").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workDays").style.display = "none"; // Hide updateFields if needed
          document.getElementById("workingHours").style.display = "none"; // Hide updateFields if needed
          document.getElementById("staffPassword").style.display = "block"; // Hide updateFields if needed
        }
      }
      function updateTable(data) {
        var tableBody = document.querySelector(".content-table tbody");

        // Clear existing table rows
        tableBody.innerHTML = "";

        // Check if data is not undefined and has elements
        if (data && data.length > 0) {
          // Populate the table with search results
          data.forEach(function (row) {
            var newRow = document.createElement("tr");
            newRow.innerHTML = `
                    <td>${row.staffID}</td>
                    <td>${row.staffName}</td>
                    <td>${row.jobDescription}</td>
                    <td>${row.salary}</td>
                    <td>${row.staffPhoneNumber}</td>
                    <td>${row.workDays}</td>
                    <td>${row.workingHours}</td>
                    <td>${row.staffPassword}</td>

                `;
            tableBody.appendChild(newRow);
          });
        } else {
          // Display a message if no results are found
          var newRow = document.createElement("tr");
          newRow.innerHTML = "<td colspan='3'>No matching results found</td>";
          tableBody.appendChild(newRow);
        }
      }
    </script>
    <!--*********************************************************************-->

    <!--*********************************************************************-->
    <div class="side-nav">
      <ul>
        <a href="{{ url_for('homepage') }}">
          <li>
            <img src="../static/images/home_.png" />
            <p>Home</p>
          </li>
        </a>
        <!--**************************************************************-->
        <a href="{{ url_for('patient') }}">
          <li>
            <img src="../static/images/heartbeat.png" />
            <p>Patients</p>
          </li>
        </a>
        <!--**************************************************************-->

        <a href="{{ url_for('Appointment') }}">
          <li>
            <img src="../static/images/appointment.png" />
            <p>Appointment</p>
          </li>
        </a>
        <!--**************************************************************-->
        <a href="{{ url_for('treatmentPlan') }}">
          <li>
            <img src="../static/images/dentist-tools.png" />
            <p>Treatment plan</p>
          </li>
        </a>
        <!--**************************************************************-->
        <a href="{{ url_for('laboratory') }}">
          <li>
            <img src="../static/images/chemical-analysis.png" />
            <p>Laboratory</p>
          </li>
        </a>
        <!--**************************************************************-->

        <a href="{{ url_for('patientPayment') }}">
          <li>
            <img src="../static/images/payment-method.png" />
            <p>Patient Payment</p>
          </li>
        </a>
        <!--**************************************************************-->
        <a href="{{ url_for('clinicExpenses') }}">
          <li>
            <img src="../static/images/accounting.png" />
            <p>Clinic Expenses</p>
          </li>
        </a>
        <!--**************************************************************-->
        <a href="{{ url_for('equipment') }}">
          <li>
            <img src="../static/images/dentist-chair.png" />
            <p>Equipment</p>
          </li>
        </a>
        <!--**************************************************************-->
        <a href="{{ url_for('supplier') }}">
          <li>
            <img src="../static/images/delivery-courier.png" />
            <p>Supplier</p>
          </li>
        </a>
        <a href="{{ url_for('Queries') }}">
          <li>
            <img src="../static/images/report.png" />
            <p>Reports</p>
          </li>
        </a>
      </ul>
      <!--**************************************************************-->
      <ul>
        <a href="{{ url_for('index') }}">
          <li>
            <img src="../static/images/exit.png" />
            <p>Logout</p>
          </li>
        </a>
      </ul>
    </div>
  </body>
</html>
